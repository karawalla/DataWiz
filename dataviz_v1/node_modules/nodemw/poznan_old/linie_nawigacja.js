var SUMMARY = 'Dodano zalążek infoboxa',
	template = "{{Linia tramwajowa infobox";

var bot = require('../lib/bot').bot;

var client = new bot({
	server: 'poznan.wikia.com',
	//debug: true
});

// log in
client.logIn('Pyrabot', 'pyr4pyr4', function(data) {
	for (var l=1; l<=26; l++) {
		(function(line) {
			var page = 'Linia tramwajowa nr ' + line;

			client.getArticle(page, function(content) {
				//console.log(page); console.log(content); return;

				// dodano już szablon
				if (!content || content.indexOf(template) > -1) {
					return;
				}

				// usuń kategorie
				content = content.replace(/\[\[Kategoria\:.*\]\]/g, '');

				var infobox = "{{Linia tramwajowa infobox\n" +
					"|numer=" + line + "\n" +
					"|historyczna=\n|foto=\n|pętla1=\n|pętla2=\n|dlugosc=\n|uruchomiona=\n|zlikwidowana=\n|tabor=\n|wydział=\n|historia=\n}}";

				// dodaj infobox
				content = infobox + "\n" + content;

				console.log('\n\n================================\n' + page + '\n================================');
				console.log(content);

				// and save it
				/**/
				client.edit(page, content, SUMMARY, function(data) {
					console.log('\n\n> ' + page + ' edited!');
				});
				/**/
			});
		})(l);
	}
});
